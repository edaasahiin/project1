#fileOperations_and_ basicFunctions
DATA_FILE = "studies.txt"
GOAL_FILE = "goal.txt"
CONGRATS_FILE = "congrats.txt"

def clean(text):
    return text.strip()

def ensure_file(path):
    with open(path, "a", encoding="utf-8"):
        pass

def read_lines(path):
    ensure_file(path)
    lines = []
    with open(path, "r", encoding="utf-8") as f:
        for line in f:
            line = line.strip()
            if line:
                lines.append(line)
    return lines

def append_line(path, text):
    with open(path, "a", encoding="utf-8") as f:
        f.write(text + "\n")

def rewrite_file(path, text):
    with open(path, "w", encoding="utf-8") as f:
        f.write(text)

#addSuccess_and_work
def show_achievements():
  records = read_lines(CONGRATS_FILE)
  if len(records)>0:
      for record in records:
        print(record)
  else:
    print("No achievements yet.")

def add_study():
  subject=clean(input("Subject:"))
  duration=clean(input("Duration(minutes):"))
  if subject==""or duration ==""or not duration.isdigit():
     print("Invalid input.")
  else:
    append_line(DATA_FILE,subject+"|"+duration)
    print("Study added.")

#recordViewing_and_statistics
def view_records():
    lines = read_lines(DATA_FILE)
    if len(lines) == 0:
       print("No records.")
       return

    total = 0
    longest = 0
    longest_subject = ""
    count = 0

    for idx, line in enumerate(lines, start=1):
        parts = line.split("|")
        if len(parts) == 2:
           subject = clean(parts[0])
           dur_text = clean(parts[1])
           if dur_text.isdigit():
              minutes = int(dur_text)
              total += minutes
              count += 1
              if minutes > longest:
                 longest = minutes
                 longest_subject = subject
           print(f"{idx}. {subject} - {dur_text} min")
        else:
           print(f"{idx}. {line} (unreadable)")

    if count > 0:
        average = total / count
    else:
        average = 0

    print(f"Total time: {total} min")
    print(f"Average: {round(average,1)} min")
    if longest > 0:
        print(f"Longest study: {longest_subject} ({longest} min)")
    else:
        print("Longest study: -")



